// ========= CONTROLFILE =========

// Archivos
match /files/{fileId} {
  allow create: if isAuth() && request.resource.data.userId == uid();
  allow read, update, delete: if isAuth() && resource.data.userId == uid();
}

// Carpetas
match /folders/{folderId} {
  allow create: if isAuth() && request.resource.data.userId == uid();
  allow read, update, delete: if isAuth() && resource.data.userId == uid();
}

// Sesiones de upload
match /uploadSessions/{sessionId} {
  allow create: if isAuth() && request.resource.data.uid == uid();
  allow read, update, delete: if isAuth() && resource.data.uid == uid();
}

// ========= SHARES (GLOBAL) =========
match /shares/{shareId} {
  allow read, write: if true;
}

// Papelera
match /trash/{trashId} {
  allow create: if isAuth() && request.resource.data.userId == uid();
  allow read, update, delete: if isAuth() && resource.data.userId == uid();
}

// Usuarios
match /users/{userId} {
  allow create: if isAuth() && userId == uid();
  allow read, update, delete: if isAuth() && userId == uid();
}

